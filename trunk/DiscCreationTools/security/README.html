<html>
<head>
<title>Security Tools</title>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<meta content="text/html; charset=UTF-8" http-equiv="Content-Type" />
<style type="text/css">
<!--
BODY {
        font-family:  Verdana, Arial, Helvetica, sans-serif
}
-->
</style>
</head>
<body>
<h1><center>Security  Tools</center></h1>
<p>

This project contains the security tools required for developing BD-J
Applications.
  
Here is the list of tools we currently have available:
<p>

<ul>
	<li><a href="#BDCert">BDCertGenerator</a> - generates the root, application and binding unit root certificates according to BD-J Specification.
<p>
<li> <a href="#BDSigner">BDSigner</a> -- signs the jars using keys generated by the BDCertGenerator.
This tool also <a href="#BUMF"> signs BUMF</a> (Binding Unit Manifest File) and
can be used to generate online.sig file.
<p>
<li> <b>BDCredentialSigner</b> --Generates the file credentials and signs the jar file.
For more information on this tool please refer to CREDENTIALS-README.TXT file
of this directory.
</ul>

<p>

<h2> Certificate Generation and Signing </h2>

There are two steps involved in signing a BD-J application.
<p>
Step 1: Generate the ceritficate{s} and key{s} for signing.<br>
Step 2: Sign the application jar using a key{s} generate above.
<p>

<h3><a name=BDCert>Step 1: Certificate Generation:</a></h3>

BDCertGenerator tool can be used for generating certificates for
the BD-J Platform. This tool generates three types of certificates
for singing the application jar and the Binding Unit Manifest File (BUMF).

<h4>SYNOPSIS</h4>

<BLOCKQUOTE>
	<P><B><CODE>BDCertGenerator -root|-app|-binding [options] [organization_id]</CODE></B></P> 
</BLOCKQUOTE>
<p>
The <b>mandatory</b> argument for this tool is the type of the certificate.
It could be either:
<p>

 	"-root" or "-app" or "-binding"
<p>
The organization_id (orgID) is required based on the type of certificate.
For example,

If the certificate type is "root", the orgID is not mandated.
<p>
If the type is "app", the orgID is typically required, unless it's a
non-leaf certificate (i.e the certificate is not used for signing the application). In this case the tool does not mandate the orgID but warns the user about
adding an orgID in the certificate.
<p>
And finally, if the certificate type is "binding" an orgID corresponding
to the one used in the bumf.xml (or whatever BUMF file name is) must be used.
<p>
For other options type: 
<BLOCKQUOTE>
<PRE>
	BDCertGenerator -help
</BLOCKQUOTE>
</PRE>

<h4>Example:</h4>
Lets say, SEC_HOME, an environment variable represents the path to the directory
where hdcookbook security jar resides.
	<BLOCKQUOTE>
		<PRE>set SEC_HOME=&lt;path to the security jar&gt;</PRE>
	</BLOCKQUOTE>

	The security.jar resides in the directory below:
	<BLOCKQUOTE>
	<PRE>&lt;HDCOOKBOOK_HOME&gt;\DiscCreationTools\security\build</PRE>
	</BLOCKQUOTE>
<p>
And BC_HOME, an environment variable represents the path to the directory
where the Bouncy Castle Provider jar resides. 
We are using: bdprov-jdk15-137.jar, a bouncycastle distribution, it should
be fine to use the later versions as well.
A copy of which can be found in the "resource" directory of security tools.
For more information see: <a href="http://www.bouncycastle.org/"> Bouncy Castle
	 Provider</a>.
	<BLOCKQUOTE>
		<PRE>set BC_HOME=&lt;path to the bouncy castle jar&gt;</PRE>
	</BLOCKQUOTE>
	<p>
	Set the CLASSPATH variable:
		<BLOCKQUOTE>
		<PRE>set CLASSPATH=%CLASSPATH%;%SEC_HOME%;%BC_HOME%</PRE>
	</BLOCKQUOTE>
	<p>
	<hr>
	<b>Note:</b> All the examples below assume that the CLASSPATH variable is set as above before invoking the security tools.
	<hr>
	<p>	
Here is the command line for generating a root certificate.
<p>
<BLOCKQUOTE>
<PRE>java net.java.bd.tools.security.BDCertGenerator -root 7fff0001</PRE>
</BLOCKQUOTE>
Here is the command line for generating an application certificate.
<p>
<BLOCKQUOTE>
<PRE>java net.java.bd.tools.security.BDCertGenerator -app 7fff0001</PRE> 
</BLOCKQUOTE>
Place the generated certificate file: app.discroot.crt,
in the <BLOCKQUOTE><PRE>BDMV\CERTIFICATE</BLOCKQUOTE></PRE> and
<BLOCKQUOTE><PRE>BDMV\CERTIFCATE\BACKUP</BLOCKQUOTE></PRE> directories.

<h3><a name=BDSigner>Step 2: Signing application jar</a></h3>

BDSigner tool can be used for signing the application jar. This tool can
also be used for signing BUMF using the Binding Unit Root certificate. It can
also generate "online.sig" file provided BDA generated private key is imported
into the keystore.

<H4>SYNOPSIS</H4>

<BLOCKQUOTE>
	<P><B><CODE>BDSigner [options] BUMF|app.discroot.crt|jarfiles</B></P> 

</BLOCKQUOTE>
<p>
The <b>mandatory</b> argument for this tool is one or more jarfiles, or a
BUMF file in case BUMF signing or an application certificate for online.sig
generation.
<p>
For other options type:
	<BLOCKQUOTE>
	<PRE>
	BDSigner -help.
	</PRE>
	</BLOCKQUOTE>
<p>
<h4>Example:</h4>
The signing key for the BDSigner to sign the jars is generated in Step 1.
<p>
Here is the command line for signing the jar.
<p>
	<BLOCKQUOTE>
	<PRE>
	java net.java.bd.tools.security.BDSigner 00000.jar 
	</PRE>
	</BLOCKQUOTE>
BDsigner is built on top of JDK's jarsigner which is bundled in tools.jar 
 
<p>

<h4> Why can't we just use the standard "jarsigner" tool in Java SE?</h4>

Blu-Ray specification requires an extra header in the signature 
manifest file in signed jar files.  The signature manifest file 
must have an attribute called "BDJ-Signature-Version" with the 
value of "1.0". Please refer to the section "12.1.4.2" of the
"System Description Blu-Ray Disc Read-Only Format - Part 3
Audio Visual Basic Specifications" - DRAFT Version 2.02".

The "jarsigner" tool in Java SE generates signature manifest 
file automatically. There is no way to specify extensions to 
the signature manifest file. So, it can not be used to sign
jars for BD-J. 
<hr>

<h3><a name=BUMF>Signing BUMF</a></h3>
Here is an example of signing a BUMF using some of the options provided
by the tools described above.

Lets generate a binding unit root certificate with an alias:bucert and
a key password: mypass, created in a new keystore: bindingstore, with a
password: mystorepass
<p>

	Here is the command line to generate a binding unit root certificate.
	<BLOCKQUOTE>
	<PRE>
	java net.java.bd.tools.security.BDCertGenerator -binding -keystore binding.store -storepass mystorepass -alias mybinder -keypass mypass -debug 00000001 
	</PRE>
	</BLOCKQUOTE>
	<p>

	The tool prints the following debug messages:
	   
	<BLOCKQUOTE>
	<PRE>
	Certificate stored in file <bu.discroot.crt>
	Starting the verfication for certificate file:bu.discroot.crt 
	Checking the certiticate
	Done with the verification for the certificate file:bu.discroot.crt
        </PRE>
	</BLOCKQUOTE>
	<p>

Now, lets sign a BUMF file named: bumf.xml using the above keystore.
<p>
Here is the command line to sign BUMF
	<BLOCKQUOTE>
	<PRE>
	java net.java.bd.tools.security.BDSigner -keystore binding.store -storepass mystorepass -alias mybinder -keypass mypass -debug bumf.xml
	</PRE>
	</BLOCKQUOTE>
	<p>

	The tool prints the following debug messages:
	<BLOCKQUOTE>
	<PRE>
	Signer of bumf.xml file is:mybinder
	Verifier of bumf.sf file is:mybinder
	BUSF Verification PASSED..
	The signed file is written into:bumf.sf
        </PRE>
	</BLOCKQUOTE>
	<p>
	<hr>
	<b>Note:</b> If the default keystores, passwords and aliases are used, then the command line for signing a BUMF file is very simple as below:
  	<BLOCKQUOTE>
  	<PRE>
  	java net.java.bd.tools.security.BDCertGenerator -binding 00000001
  	java net.java.bd.tools.security.BDSigner bumf.xml
  	</PRE>
  	</BLOCKQUOTE>
  	<p>
	<hr>
	


