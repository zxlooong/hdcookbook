#
# A show file for testing various features of GRIN.  Generally, these are
# grouped as related segments.  Each group of related segments and features
# is set off in the file with a big block comment, and each group uses a
# common naming prefix.
#


show


####################################################################
#
#			DRAWING OPTIMIZATION
#
# These segments help to demonstrate drawing optimization.  We have
# three independent animations going on:  A pair of turtle troopers
# moving back and forth, a picture that fades in and out, and
# a gun bunny who moves around the screen.
#
# The same animation is presented in three different segments:
#
#	Unoptimized  -- no effot at optimizing drawing
#       Targets      -- drawing targets used to reduce draw area
#       Guarantee    -- Like targets, plus a guarantee_fill operation
# 			is used to cut down on the erase overhead of
#			the turtles
#
# To see what's going on, bring this up in grinviewer or GrinViewerXlet,
# and step through the animation in "Watch drawing" mode.  You should
# see the differences in the erase areas and the drawing areas.
#
# Remember that optimizing the erase areas so that large areas aren't
# unnecessarily erased is important, because every pixel in the erase
# area has to be drawn to.  Optimizing the draw area is also important,
# but it's OK if a large empty area of the screen is in the draw area;
# that doesn't hurt so much, because no drawing operations are actually
# done there.
# 
####################################################################

segment S:DrawOpt.Initialize
    setup {
	F:DrawOpt.Everything
    } setup_done {
	activate_segment S:DrawOpt.Guarantee ;
    }
;

segment S:DrawOpt.Guarantee
    active {
	F:DrawOpt.Troopers
	F:DrawOpt.Troopers.Coords
	F:DrawOpt.Bunny
	F:DrawOpt.Bunny.Coords
	F:DrawOpt.FadingPicture
    } setup {
	F:DrawOpt.Everything
    }
;

feature translation F:DrawOpt.Troopers.Coords {
	0	 200 900		linear
	40	1700 900		linear
	80	 200 900		linear
} repeat 1 ;

feature translator F:DrawOpt.Troopers 
    F:DrawOpt.Troopers.Coords {
	F:DrawOpt.Trooper.1
	F:DrawOpt.Trooper.2
    } 
;

feature fixed_image F:DrawOpt.Trooper.1 200 900 "images/turtle_trooper.png" ;
feature fixed_image F:DrawOpt.Trooper.2 300 900 "images/turtle_trooper.png" ;

feature translation F:DrawOpt.Bunny.Coords {
    	  0	 100  100	linear
	 30	 100  700	linear
	 70	1720  650	linear
	100	 100  100	linear
} repeat 1 ;

feature translator F:DrawOpt.Bunny
    F:DrawOpt.Bunny.Coords {
    	F:DrawOpt.Bunny.Im
    }
;


feature fixed_image F:DrawOpt.Bunny.Im 100 100 "images/bunny_00.png" ;
	# 175x200 pixels


feature fade F:DrawOpt.FadingPicture F:DrawOpt.Picture src_over { 
	0	0	linear
	30	255	linear
	80	255	linear
	100	0	linear
    }
;
# @@ Need "repeat" on fade!

feature fixed_image F:DrawOpt.Picture 1500 500 "images/bunny_with_gun.png" ;


feature group F:DrawOpt.Everything {
	F:DrawOpt.Troopers
	F:DrawOpt.Troopers.Coords
	F:DrawOpt.Bunny.Coords
	F:DrawOpt.Bunny
	F:DrawOpt.FadingPicture
} ;


####################################################################
#  End of show file
####################################################################

end_show
